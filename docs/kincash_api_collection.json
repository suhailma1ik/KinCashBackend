{
  "info": {
    "_postman_id": "b5a7e8f3-9b2c-4d7e-9f2a-8c5e6d7f8a9b",
    "name": "KinCash API",
    "description": "API collection for the KinCash Backend",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "description": "Authentication endpoints",
      "item": [
        {
          "name": "Register User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"phone_number\": \"+1234567890\",\n  \"password\": \"securepassword\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/register/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "register",
                ""
              ]
            },
            "description": "Register a new user"
          },
          "response": []
        },
        {
          "name": "Login with Email",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\",\n  \"password\": \"securepassword\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/login/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "login",
                ""
              ]
            },
            "description": "Login with email"
          },
          "response": []
        },
        {
          "name": "Login with Phone Number",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"phone_number\": \"+1234567890\",\n  \"password\": \"securepassword\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/login/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "login",
                ""
              ]
            },
            "description": "Login with phone number"
          },
          "response": []
        },
        {
          "name": "Refresh Token",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"refresh\": \"your_refresh_token_here\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/token/refresh/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "token",
                "refresh",
                ""
              ]
            },
            "description": "Refresh JWT token"
          },
          "response": []
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/user/logout/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "logout",
                ""
              ]
            },
            "description": "Logout user"
          },
          "response": []
        }
      ]
    },
    {
      "name": "User Management",
      "description": "User management endpoints",
      "item": [
        {
          "name": "Get User Profile",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/user/profile/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "profile",
                ""
              ]
            },
            "description": "Get user profile"
          },
          "response": []
        },
        {
          "name": "Update User Profile",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"first_name\": \"Updated\",\n  \"last_name\": \"Name\",\n  \"phone_number\": \"+9876543210\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/profile/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "profile",
                ""
              ]
            },
            "description": "Update user profile"
          },
          "response": []
        },
        {
          "name": "Request Password Reset",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"user@example.com\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/user/password-reset/request/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "user",
                "password-reset",
                "request",
                ""
              ]
            },
            "description": "Request password reset"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Loans",
      "description": "Loan management endpoints",
      "item": [
        {
          "name": "Create Loan",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lender\": \"lender_user_id\",\n  \"borrower\": \"borrower_user_id\",\n  \"principal_amount\": 1000,\n  \"interest_rate\": 5.0,\n  \"term_months\": 12,\n  \"emi_cycle\": \"MONTHLY\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/loan/create_loan/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "loan",
                "create_loan",
                ""
              ]
            },
            "description": "Create a new loan"
          },
          "response": []
        },
        {
          "name": "Get All Loans",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/loan/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "loan",
                ""
              ]
            },
            "description": "Get all loans for the current user"
          },
          "response": []
        },
        {
          "name": "Get Loan By ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/loan/{{loan_id}}/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "loan",
                "{{loan_id}}",
                ""
              ]
            },
            "description": "Get loan details by ID"
          },
          "response": []
        },
        {
          "name": "Get Loan Schedule",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/loan/{{loan_id}}/schedule/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "loan",
                "{{loan_id}}",
                "schedule",
                ""
              ]
            },
            "description": "Get repayment schedule for a loan"
          },
          "response": []
        },
        {
          "name": "Accept Loan",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/loan/{{loan_id}}/accept/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "loan",
                "{{loan_id}}",
                "accept",
                ""
              ]
            },
            "description": "Accept a loan offer"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Payments",
      "description": "Payment management endpoints",
      "item": [
        {
          "name": "Create Payment",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"loan\": \"loan_id\",\n  \"amount\": 100,\n  \"idempotency_key\": \"unique_string_to_prevent_duplicate_payments\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/payments/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "payments",
                ""
              ]
            },
            "description": "Create a new payment"
          },
          "response": []
        },
        {
          "name": "Get All Payments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "payments",
                ""
              ]
            },
            "description": "Get all payments for the current user"
          },
          "response": []
        },
        {
          "name": "Get Payment By ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/payments/{{payment_id}}/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "payments",
                "{{payment_id}}",
                ""
              ]
            },
            "description": "Get payment details by ID"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Notifications",
      "description": "Notification management endpoints",
      "item": [
        {
          "name": "Get All Notifications",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/notifications/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "notifications",
                ""
              ]
            },
            "description": "Get all notifications for the current user"
          },
          "response": []
        },
        {
          "name": "Mark Notification as Read",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/notifications/{{notification_id}}/read/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "notifications",
                "{{notification_id}}",
                "read",
                ""
              ]
            },
            "description": "Mark a notification as read"
          },
          "response": []
        },
        {
          "name": "Mark All Notifications as Read",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{access_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/notifications/mark-all-read/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "notifications",
                "mark-all-read",
                ""
              ]
            },
            "description": "Mark all notifications as read"
          },
          "response": []
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-extract tokens from login response",
          "if (pm.response.code === 200 && pm.request.url.toString().includes('/login')) {",
          "    const jsonResponse = pm.response.json();",
          "    if (jsonResponse.data && jsonResponse.data.token) {",
          "        pm.environment.set('access_token', jsonResponse.data.token.access);",
          "        pm.environment.set('refresh_token', jsonResponse.data.token.refresh);",
          "        console.log('Tokens extracted and saved to environment variables');",
          "    }",
          "}"
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    }
  ]
}
